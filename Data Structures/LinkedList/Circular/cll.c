#include<stdio.h>
#include<stdlib.h>
#include"cll.h"

/*-----------------------------------------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------------------------------------------
------------------------------------------------------------------------------------------------------------------------------------------------------------------*/

/*********************************************************************
** Print List : A function that			  							**
**    Takes  :												 	    **
**	   1- pointer to the first node (called : last)					**
**    Returns:													  	**
**  		  Nothing  												**
**	 																**
**********************************************************************/

void DisplayCircularList(cnode_t* last)
{
	cnode_t* ptr;
	
	if(last == NULL)
	{
		printf("\nThe List is Empty !\n");
		
	}
	else
	{
		
		ptr=last->link;
		printf("The List Is : \n");
		do
		{
			printf("%d ",ptr->info);
			ptr=ptr->link;
		}
		while(ptr != last->link);
		
		printf("\n");
		
	}
	
}




/*-----------------------------------------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------------------------------------------
------------------------------------------------------------------------------------------------------------------------------------------------------------------*/

cnode_t* InsertInEmpty(cnode_t* last , int data)
{
	cnode_t* temp = (cnode_t*)malloc(sizeof(cnode_t));
	
	temp->info = data;
	temp->link=temp;
	last=temp;
	
	return last;
}

/*-----------------------------------------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------------------------------------------
------------------------------------------------------------------------------------------------------------------------------------------------------------------*/



void InsertAtBeginning(cnode_t* last , int data)
{
	cnode_t* temp = (cnode_t*)malloc(sizeof(cnode_t));
	
	temp->info = data;
	
	temp->link=last->link;
	
	last->link=temp;
	
}


/*-----------------------------------------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------------------------------------------
------------------------------------------------------------------------------------------------------------------------------------------------------------------*/



cnode_t* InsertAtEnd(cnode_t* last , int data)
{
	cnode_t* temp = (cnode_t*)malloc(sizeof(cnode_t));
	
	temp->info = data;
	
	temp->link= last->link;
	last->link=temp;
	
	last=temp;
	
	return last;

}


/*-----------------------------------------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------------------------------------------
------------------------------------------------------------------------------------------------------------------------------------------------------------------*/



cnode_t* CreateList(cnode_t* last)
{
	
	int i , data , n; 
	
	printf("Enter number of nodes need : ");
	scanf("%d",&n);
	if(n==0)
	{
		printf("\nInvalid number\n");
	}
	else
	{
		printf("Enter the value of node 1 : ");
		scanf("%d",&data);
		last= InsertInEmpty(last ,data);
		
		for(i=1 ; i<n ; i++)
		{
			printf("Enter the value of node %d : ",i+1);
			scanf("%d",&data);
			last=InsertAtEnd(last,data);
		}
		
	}
	
	return last;
	
}

/*-----------------------------------------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------------------------------------------
------------------------------------------------------------------------------------------------------------------------------------------------------------------*/



cnode_t* InsertAfter(cnode_t* last, int afterdata , int data)
{
	
	cnode_t* ptr = last->link;
	
	do
	{
		if(ptr->info == afterdata)
		{
			break;
		}
		else
		{
			ptr=ptr->link;
		}
		
		
	}while(ptr != last->link);
	
	if((ptr == last->link) && (ptr->info != afterdata))
	{
		
		printf("%d Is Not Found\n",afterdata);
	}
	else if(ptr==last)
	{
		last=InsertAtEnd(last ,data);
	}
	else
	{
		cnode_t* temp = (cnode_t*)malloc(sizeof(cnode_t));
	
		temp->info = data;
		
		temp->link=ptr->link;
		ptr->link= temp;
		
	}
	
	return last;
}


/*-----------------------------------------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------------------------------------------
------------------------------------------------------------------------------------------------------------------------------------------------------------------*/


void CountNodes(cnode_t* last)
{
	int ctr=0;
	
	cnode_t* ptr=last->link;
	
	do
	{
		ptr=ptr->link;
		ctr++;
	}while(ptr !=last->link);
	
	printf("\nThe Number Of nodes : %d\n",ctr);
}

/*-----------------------------------------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------------------------------------------
------------------------------------------------------------------------------------------------------------------------------------------------------------------*/




int SearchNodes(cnode_t* last, int data)
{
	cnode_t * ptr = last->link;
	int pos=1;
	
	do
	{
		if(ptr ->info == data) 
		{
			break;
		}
		else
		{
			ptr=ptr->link;
			pos++;
		}
	}while(ptr!= last->link);
	
	if(ptr== last->link)
	{
		printf("\n%d Not Found In The List\n",data);
	}
	else
	{
		printf("%d Is At Position %d",data,pos);
		return pos;
	}
}

/*-----------------------------------------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------------------------------------------
------------------------------------------------------------------------------------------------------------------------------------------------------------------*/



void InsertBefore(cnode_t* last, int beforedata , int data)
{
	cnode_t* ptr=last->link;
	
	do
	{
		if(ptr->link->info == beforedata)
		{
			break;
		}
		else
		{
			ptr=ptr->link;
		}
	}while(ptr!= last);
	
	if(ptr->link == last->link && ptr->link->info != beforedata)
	{
		printf("%d isn't found in the list\n",beforedata);
	}
	else
	{
		cnode_t* temp = (cnode_t*)malloc(sizeof(cnode_t));
	
		temp->info = data;
		
		temp->link = ptr->link;
		
		ptr->link=temp;
		
	}
	
	
}


/*-----------------------------------------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------------------------------------------
------------------------------------------------------------------------------------------------------------------------------------------------------------------*/





cnode_t* DeleteNode(cnode_t* last , int data)
{
	cnode_t  *temp , *ptr ;
	
	if(last == NULL)
	{
		printf("The List Is Empty\n");
	}
	/*deletion of the only node*/
	else if ((last->link == last )&& (last->info == data))
	{
		temp=last;
		last= NULL;
		free(temp);
		return last;
	}
	/*delete the first node*/
	else if (last->link->info == data)
	{
		temp=last->link;
		last->link = temp->link;
		free(temp);
	}
	else
	{
		
		ptr=last->link;
		while(ptr->link != last)
		{
			if(ptr->link->info == data)
			{
				break;
			}
			else
			{
				ptr=ptr->link;
			}
		}
		if(ptr->link != last)
		{
			/*delete in between*/
			temp=ptr->link;
			ptr->link=temp->link;
			free(temp);
		
		}
		else
		{
			/*delete the last node*/
			if(ptr->link->info == data)
			{
				temp=last;
				ptr->link=last->link;
				free(temp);
				last=ptr;
			}
			else
			{
				/*not found*/
				printf("%d Is not found\n");
			}
			
		}
	}
	
	return last;
}